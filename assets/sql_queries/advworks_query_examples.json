{
    "Calculate the average percentage increase in sales amount for repeat purchases for every zipcode. Repeat purchase is a purchase subsequent to the first purchase (the average should always be computed relative to the first purchase)": "SELECT AVG((s.SalesAmount - first_purchase.SalesAmount) / first_purchase.SalesAmount * 100) AS AvgPercentageIncrease\r\nFROM factinternetsales s\r\nINNER JOIN dimcustomer c ON s.CustomerKey = c.CustomerKey\r\nINNER JOIN dimgeography g ON c.GeographyKey = g.GeographyKey\r\nINNER JOIN (\r\n\tSELECT *\r\n\tFROM (\r\n\t\tSELECT\r\n\t\t\tCustomerKey,\r\n\t\t\tSalesAmount,\r\n            OrderDate,\r\n\t\t\tROW_NUMBER() OVER (PARTITION BY CustomerKey ORDER BY OrderDate) AS RowNumber\r\n\t\tFROM factinternetsales\r\n\t) AS t\r\n\tWHERE RowNumber = 1\r\n) first_purchase ON s.CustomerKey = first_purchase.CustomerKey\r\nWHERE s.OrderDate > first_purchase.OrderDate\r\nGROUP BY g.PostalCode;",
    "Show the monthly total and year-to-date total sales. Order by year and month.": "SELECT\r\n    Year,\r\n\tMonth,\r\n\tMonthlySales,\r\n\tSUM(MonthlySales) OVER (PARTITION BY Year ORDER BY Year, Month ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS CumulativeTotal\r\nFROM (\r\n\tSELECT\r\n\t   YEAR(OrderDate) AS Year,\r\n\t   MONTH(OrderDate) AS Month,\r\n\t   SUM(SalesAmount) AS MonthlySales\r\n\tFROM factinternetsales\r\n\tGROUP BY YEAR(OrderDate), MONTH(OrderDate)\r\n) AS t"
}